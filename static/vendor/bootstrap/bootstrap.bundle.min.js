(() => {
  const collapseToggle = (trigger) => {
    const targetSelector = trigger.getAttribute("data-bs-target");
    if (!targetSelector) return;
    const target = document.querySelector(targetSelector);
    if (!target) return;
    target.classList.toggle("show");
  };

  const tabToggle = (trigger) => {
    const targetSelector = trigger.getAttribute("data-bs-target");
    if (!targetSelector) return;
    const target = document.querySelector(targetSelector);
    if (!target) return;
    const tabContainer = trigger.closest(".nav");
    if (tabContainer) {
      tabContainer.querySelectorAll(".nav-link").forEach((link) => link.classList.remove("active"));
    }
    trigger.classList.add("active");
    const tabContent = target.parentElement;
    if (tabContent) {
      tabContent.querySelectorAll(".tab-pane").forEach((pane) => {
        pane.classList.remove("active", "show");
      });
    }
    target.classList.add("active", "show");
  };

  const accordionToggle = (trigger) => {
    const targetSelector = trigger.getAttribute("data-bs-target");
    if (!targetSelector) return;
    const target = document.querySelector(targetSelector);
    if (!target) return;
    const parentSelector = target.getAttribute("data-bs-parent");
    if (parentSelector) {
      const parent = document.querySelector(parentSelector);
      if (parent) {
        parent.querySelectorAll(".accordion-collapse").forEach((item) => {
          if (item !== target) item.classList.remove("show");
        });
      }
    }
    target.classList.toggle("show");
  };

  document.addEventListener("click", (event) => {
    const trigger = event.target.closest("[data-bs-toggle]");
    if (!trigger) return;
    const action = trigger.getAttribute("data-bs-toggle");
    if (action === "collapse") {
      event.preventDefault();
      if (trigger.closest(".accordion")) {
        accordionToggle(trigger);
      } else {
        collapseToggle(trigger);
      }
    }
    if (action === "pill") {
      event.preventDefault();
      tabToggle(trigger);
    }
  });
})();
